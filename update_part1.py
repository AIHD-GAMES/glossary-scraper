
import gspread
from oauth2client.service_account import ServiceAccountCredentials

def update_glossary():
    scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
    creds = ServiceAccountCredentials.from_json_keyfile_name('/Users/matsuyamakoichi/service-account.json', scope)
    client = gspread.authorize(creds)
    
    spreadsheet_id = '1JwA5HPNvMmNwADjyCDdNaRg2XPu2hzO9SFAo72qjBnw'
    sh = client.open_by_key(spreadsheet_id)
    worksheet = sh.worksheet('シート1')
    
    # [頭文字, 用語集, 読み方, 意味]
    data = [
        ["あ", "相対取引", "あいたいとりひき", "証券取引所などの公的な市場を通さず、売り手と買い手が直接、価格や売買数量、決済方法などを交渉して成立させる取引形態。"],
        ["あ", "アイランドリバーサル", "あいらんどりばーさる", "チャート上で窓を開けて上昇（または下落）した後に、再度窓を開けて反対方向へ動くことで、特定の期間の価格帯が島のように孤立した形状。強いトレンド転換の兆しとされる。"],
        ["あ", "アウトパフォーム", "あうとぱふぉーむ", "投資信託や個別銘柄の収益率が、日経平均株価やTOPIXといった比較対象となる基準指標（ベンチマーク）を上回ること。"],
        ["あ", "赤字国債", "あかじこくさい", "税収だけでは賄えない国の歳入不足を補うために発行される特例国債。財政法第4条の規定によらない例外的な発行であるため「特例」と呼ばれる。"],
        ["あ", "アクティビスト", "あくてぃびすと", "企業の株式を保有し、株主総会での議決権行使や経営陣への提言を積極的に行うことで、企業価値向上や株主への利益還元を促す投資家の総称。"],
        ["あ", "アクティブ運用", "あくてぃぶうんよう", "特定の指数（ベンチマーク）に連動させるのではなく、それを上回る運用実績を目指して銘柄選定や投資判断を行う運用スタイル。"],
        ["あ", "アク抜け", "あくぬけ", "悪材料が出尽くしたことで株価が下げ止まり、投資家の不安感が解消されて相場が安定、あるいは上昇に転じること。"],
        ["あ", "預け替え", "あずけがえ", "投資家の指示に基づき、現在預けている証券会社から別の証券会社へ有価証券の保管場所を移す手続きのこと。一般的に「移管」とも呼ばれる。"],
        ["あ", "アセットアロケーション", "あせっとあろけーしょん", "投資資金を株式、債券、不動産、現金などの異なる資産クラスにどのような割合で配分するかを決定すること。運用の成果を左右する重要なプロセスとされる。"],
        ["あ", "アニュアルレポート", "あにゅあるれぽーと", "企業が株主や投資家向けに発行する年次報告書。業績報告だけでなく、経営戦略や財務状況、社会貢献活動などが網羅的に記載される。"],
        ["あ", "アノマリー", "あのまりー", "合理的な理論や経済原則だけでは説明がつかないものの、相場の世界で経験的に観測される特定の時期や条件での規則的な値動きや現象。"],
        ["あ", "アベノミクス", "あべのみくす", "2012年から始まった第2次安倍政権による経済政策。大胆な金融緩和、機動的な財政出動、民間投資を喚起する成長戦略の「3本の矢」を柱とする。"],
        ["あ", "あや", "あや", "全体的な相場トレンドとは直接関係なく、一時的な需給バランスや小さな出来事によって生じる小幅な価格の変動。"],
        ["あ", "アルゴリズム取引", "あるごりずむとりひき", "コンピューターが事前に設定された条件（価格、出来高、時間など）に従い、自動的に注文のタイミングや量を判断して執行する取引手法。"],
        ["あ", "暗号資産", "あんごうしさん", "ブロックチェーンなどの技術を用いたデジタル通貨の総称。法定通貨のような特定の国による保証はないが、電子的な決済や資産の移転に利用される。"],
        ["あ", "安定株主", "あんていかぶぬし", "企業の経営方針に理解を示し、株価の変動にかかわらず長期にわたって株式を継続保有する株主。経営陣や取引先企業などが中心となる。"],
        ["あ", "安定操作取引", "あんていそうさとりひき", "有価証券の募集や売り出しを円滑に行うため、株価が急激に変動しないよう証券会社などが市場で買い支えたり、売り出したりして価格を調整する行為。法令で厳格に規定されている。"],
        ["あ", "安定配当", "あんていはいとう", "企業の業績が多少変動しても、それに関係なく一定水準の配当を継続的に株主へ支払うこと。"],
        ["あ", "アンブレラ方式", "あんぶれらほうしき", "一つの投資信託（傘）の中に、複数の異なる運用内容を持つサブファンドを設ける仕組み。投資家は同一傘内でのスイッチング（乗り換え）が容易になる。"],
        ["い", "イールドカーブ", "いーるどかーぶ", "債券の残存期間と利回りの関係をグラフ化した「利回り曲線」のこと。景気局面や金融政策の見通しによって形状が変化する。"],
        ["い", "遺産分割", "いさんぶんかつ", "亡くなった人（被相続人）が遺した財産を、相続人全員で具体的に誰が何を継承するか分ける手続き。"],
        ["い", "遺産分割協議", "いさんぶんかつきょうぎ", "相続人全員が集まり、遺産の分け方について話し合うこと。全員の合意が必要となる。"],
        ["い", "遺産分割協議書", "いさんぶんかつきょうぎしょ", "遺産分割協議で合意に達した内容を記録した書面。相続手続きの正式な書類として利用される。"],
        ["い", "遺贈", "いぞう", "遺言によって、自身の財産を特定の個人や団体に無償で譲り渡すこと。"],
        ["い", "板", "いた", "売買注文の状況（売り注文と買い注文の価格ごとの数量）を一覧表示したもの。リアルタイムの需給状況を把握するために用いられる。"],
        ["い", "委託者", "いたくしゃ", "投資信託において、信託財産の運用指図を行う運用の専門家（投資信託運用会社）のこと。"],
        ["い", "委託手数料", "いたくてすうりょう", "投資家が証券会社に売買の仲介を依頼した際に支払う手数料。"],
        ["い", "委託保証金", "いたくほしょうきん", "信用取引を行う際、損失が生じた場合の担保として証券会社にあらかじめ預け入れる現金または有価証券。"],
        ["い", "板寄せ", "いたよせ", "取引時間（ザラバ）外に出された注文を、価格優先・時間優先の原則に基づいて突き合わせ、一つの価格で約定させる方法。寄付きや引け時に行われる。"],
        ["い", "一目均衡表", "いちもくきんこうひょう", "日本で考案されたテクニカル指標の一つ。基準線、転換線、先行スパン、遅行スパンなどを用いて、相場の「時間」と「均衡」の観点から先行きを予測する手法。"],
        ["い", "いってこい", "いってこい", "上昇した相場が、期間内に元の水準付近まで戻ってしまう、あるいはその逆の現象。値動きが相殺された状態を指す俗称。"],
        ["い", "一般勘定", "いっぱんかんじょう", "生命保険会社が受け取った保険料のうち、契約者に一定の利益還元を保証した上で、他の契約者の資産とまとめて一括運用する勘定のこと。"],
        ["い", "一般口座", "いっぱんこうざ", "特定口座を利用せず、投資家自身で年間の売買損益を計算し、確定申告を行うための口座。"],
        ["い", "一般信用", "いっぱんしんよう", "返済期限や銘柄、利率などを証券会社と顧客の間で自由に契約する信用取引の種類。取引所がルールを定める「制度信用」とは異なる。"],
        ["い", "一般担保付社債", "いっぱんたんぽつきしゃさい", "特定の資産を共同担保にするのではなく、発行企業の全財産に対して他の債権者に優先して弁済を受ける権利（一般先取特権）が付与された社債。"],
        ["い", "一般NISA", "いっぱんにーさ", "投資で得られた利益が非課税になる制度の一つ。年間120万円までの投資枠があり、最長5年間非課税で保有できる（旧制度）。"],
        ["い", "移動平均線", "いどうへいきんせん", "ある一定期間の価格の平均値をグラフ化したもの。相場のトレンドや方向性を把握するための代表的なテクニカル指標。"],
        ["い", "イベント・ドリブン", "いべんと・どりぶん", "企業の買収・合併（M&A）や不祥事、法制度の変更など、特定の出来事（イベント）をきっかけに生じる価格変動を利用して利益を狙う投資手法。"],
        ["い", "遺留分", "いりゅうぶん", "遺言の内容にかかわらず、法定相続人が最低限受け取ることができると法律で保障されている遺産の取り分。"],
        ["い", "遺留分侵害額の請求", "いりゅうぶんしんがいがくのせいきゅう", "遺留分を下回る相続しか受けられなかった相続人が、多く受け取った人に対して不足分を金銭で支払うよう求める権利の行使。"],
        ["い", "インカムゲイン", "いんかむげいん", "資産を保有し続けることで継続的に得られる収益のこと。株式の配当金や債券の利子、不動産の家賃収入などが該当する。"],
        ["い", "インサイダー取引", "いんさいだーとりひき", "会社の内部者しか知り得ない重要な未公開情報を利用して、その情報が公表される前に自社株などの売買を行う不正取引。法律で厳しく禁止されている。"],
        ["い", "陰線", "いんせん", "ローソク足チャートにおいて、始値（取引開始時の価格）よりも終値（取引終了時の価格）が安くなった場合に表示される棒状の図形。"],
        ["い", "インターバンク市場", "いんたーばんくしじょう", "銀行や証券会社などの金融機関同士が、短期的な資金の過不足を調整するために資金を貸し借りしたり、外貨を売買したりする市場。"],
        ["い", "インデックス", "いんでっくす", "市場全体の動向を把握するために、特定の銘柄群の価格を一定のルールで数値化した指標（日経平均株価やS&P500など）。"],
        ["い", "インデックス運用", "いんでっくすうんよう", "特定の指数（インデックス）と同じ値動きをすることを目指す運用手法。「パッシブ運用」とも呼ばれる。"],
        ["い", "インデックス年金", "いんでっくすねんきん", "物価指数などの指標に連動して、受け取れる年金額が変動する仕組みの年金。インフレによる実質的な価値低下を防ぐ役割がある。"],
        ["い", "インデックスファンド", "いんでっくすふぁんど", "日経平均株価などの特定の市場指数に連動するように組成された投資信託。"],
        ["い", "インバース型上場投資信託", "いんばーすがたじょうじょうとうししんたく", "対象とする市場指数とは逆の値動き（反比例）をするように設計されたETF。相場の下落局面で利益が出る仕組みになっている。"],
        ["い", "インバウンド需要", "いんばあんどじゅよう", "訪日外国人が日本国内で消費やサービスに支払うことで生じる需要。観光業や小売業に大きな影響を与える。"]
    ]
    
    # Write to sheet starting from row 2 (leaving header)
    worksheet.update('A2:D51', data)
    print("Updated 50 terms successfully.")

if __name__ == "__main__":
    update_glossary()
