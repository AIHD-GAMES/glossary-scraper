
import gspread
from oauth2client.service_account import ServiceAccountCredentials

def update_glossary():
    scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
    creds = ServiceAccountCredentials.from_json_keyfile_name('/Users/matsuyamakoichi/service-account.json', scope)
    client = gspread.authorize(creds)
    
    spreadsheet_id = '1JwA5HPNvMmNwADjyCDdNaRg2XPu2hzO9SFAo72qjBnw'
    sh = client.open_by_key(spreadsheet_id)
    worksheet = sh.worksheet('シート1')
    
    # [頭文字, 用語集, 読み方, 意味]
    data = [
        ["お", "終値", "おわりね", "証券取引所の取引時間において、一日の最後に成立した価格。その日の相場評価の基準となる重要な値。"],
        ["お", "オンライントレード", "おんらいんとれーど", "インターネットを通じて、パソコンやスマートフォンから証券会社へ直接注文を出す取引形態。"],
        ["お", "追証", "おいしょう", "追加保証金の略称。信用取引などで委託保証金率が一定（維持率）を下回った際、不足分として追加で差し入れなければならない現金や有価証券。"],
        ["お", "黄金株", "おうごんかぶ", "株主総会において、拒絶権（特定の重要事項を否決できる権利）が付与された特殊な株式。主に敵対的買収への防衛策として活用される。"],
        ["お", "王道本", "おうどうぼん", "信頼性が高く、その分野の基本や本質を網羅している正統的な解説書や専門書の俗称。"],
        ["お", "お買得", "おかどく", "本来の価値（適正価格）に比べて、現在の市場価格が割安で魅力的な状態。"],
        ["お", "送る", "おくる", "保有している資金や決済代金を、指定の口座へ移動・送金すること。"],
        ["お", "お札", "おさつ", "日本銀行が発行する日本銀行券（紙幣）の通称。"],
        ["お", "お支払方法", "おしはらいほうほう", "商品の購入代金やサービスの利用料を決済する手段や手順のこと。銀行振込、クレジットカード、代金引換など。"],
        ["お", "押し", "おし", "上昇していた相場が、利益確定売りなどによって一時的に価格を下げる局面。"],
        ["お", "折込済み", "おりこみずみ", "将来起こり得るイベントや予測データなどが、すでに現在の取引価格に反映されていること。"],
        ["お", "親子会社", "おやこがいしゃ", "一つの企業が他方の企業の株式を過半数保有し、支配・被支配の関係にある状態。"],
        ["お", "親子どんぶり", "おやこどんぶり", "同一のグループ内において、親会社と子会社がどちらも上場している「親子上場」を指す隠語。"],
        ["お", "卸売物価指数", "おろしうりぶっかしじょう", "企業間で取引される商品の価格水準を測定した指標。現在の「企業物価指数（CGPI）」に相当する。"],
        ["お", "音", "おと", "相場において、価格が変動した際に出る注文成立の音、あるいは転じて市場の活発さを指す表現。"],
        ["お", "お盆", "おぼん", "8月中旬の日本の休暇期間。この時期は市場参加者が減り、取引高が細る「夏枯れ相場」になりやすい。"],
        ["お", "オフライン", "おふらいん", "インターネットに接続されていない状態。または対面や電話などの物理的な手段でのやり取り。"],
        ["お", "オフショア市場", "おふしょあしじょう", "非居住者を対象とした、税制上の優遇措置や規制緩和が行われている国際的な金融市場。タックスヘイブンなどが含まれる。"],
        ["お", "オプション取引", "おぷしょんとりひき", "将来の特定の期日までに、特定の価格で資産を買う、あるいは売る「権利」を売買する取引。"],
        ["お", "オルタナティブ投資", "おるたなてぃぶとうし", "上場株式や債券といった伝統的資産以外の、不動産、未上場株式（プライベート・エクイティ）、コモディティ（商品）、ヘッジファンドなどへの投資。"],
        ["お", "思惑買い", "おもわくがい", "確実な根拠ではなく、将来的に上昇するという予想や期待感に基づいて株を買うこと。"],
        ["お", "思惑売り", "おもわくうり", "将来的な下落を見越した予想や主観的な判断に基づいて株を売ること。"],
        ["お", "親会社", "おやがいしゃ", "他の企業の意思決定を支配し、経営をコントロールしている企業。一般的に議決権の50％超を保有する。"],
        ["お", "親権者", "しんけんしゃ", "未成年の子供を養育・保護し、その財産を管理する法的権限を持つ者。"],
        ["お", "お年玉", "おとしたま", "正月の祝いとして贈られる金品。転じて、新年の相場で利益が得られるような幸運な局面を指すこともある。"],
        ["お", "落とす", "おとす", "口座から代金を引き落とすこと、あるいは相場が急落すること。"],
        ["お", "踊り場", "おどりば", "上昇または下落を続けてきた相場が、一旦横ばい（もち合い）状態になり、次の動きを待っている局面。"],
        ["お", "オフバランス取引", "おふばらんすとりひき", "企業の貸借対照表（バランスシート）に資産や負債として記載されない取引のこと。リース取引やデリバティブ取引の一部などが該当する。"],
        ["お", "温故知新", "おんこちしん", "過去の価格推移や歴史的な相場パターンを学ぶことで、将来の指針を得ること。"]
    ]
    
    # Write to sheet starting from row 102
    worksheet.update('A102:D130', data)
    print("Updated remaining terms successfully.")

if __name__ == "__main__":
    update_glossary()
